<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/phala-cloud-community/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/phala-cloud-community/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li:not(:nth-child(10)) > a, .site-nav > ul.nav-list:first-child > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(10) > a { font-weight: 600; text-decoration: none; } .site-nav > ul.nav-category-list > li > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(10) > button svg { transform: rotate(-90deg); } .site-nav > ul.nav-category-list > li.nav-list-item > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(10) > ul.nav-list { display: block; } </style> <script src="/phala-cloud-community/assets/js/vendor/lunr.min.js"></script> <script src="/phala-cloud-community/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>CVM Management | Phala Cloud Docs</title> <meta name="generator" content="Jekyll v4.3.4" /> <meta property="og:title" content="CVM Management" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Phala Cloud is a cloud service that allows you to deploy arbitrary dockerized applications into TEE." /> <meta property="og:description" content="Phala Cloud is a cloud service that allows you to deploy arbitrary dockerized applications into TEE." /> <link rel="canonical" href="https://phala-network.github.io/phala-cloud-community/management/" /> <meta property="og:url" content="https://phala-network.github.io/phala-cloud-community/management/" /> <meta property="og:site_name" content="Phala Cloud Docs" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="CVM Management" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Phala Cloud is a cloud service that allows you to deploy arbitrary dockerized applications into TEE.","headline":"CVM Management","url":"https://phala-network.github.io/phala-cloud-community/management/"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/phala-cloud-community/" class="site-title lh-tight"> Phala Cloud Docs </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/phala-cloud-community/intro/" class="nav-list-link">Introduction</a></li><li class="nav-list-item"><a href="/phala-cloud-community/deployment/deploy-with-docker-compose/" class="nav-list-link">Deploy with Docker Compose</a></li><li class="nav-list-item"><a href="/phala-cloud-community/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="/phala-cloud-community/get-started/" class="nav-list-link">Get Started</a></li><li class="nav-list-item"><a href="/phala-cloud-community/deployment/set-secure-environment-variables/" class="nav-list-link">Deploy with Docker Compose</a></li><li class="nav-list-item"><a href="/phala-cloud-community/deployment/deploy-with-private-docker-image/" class="nav-list-link">Deploy with Private Docker Image</a></li><li class="nav-list-item"><a href="/phala-cloud-community/migration/" class="nav-list-link">Migrate Applications to TEE</a></li><li class="nav-list-item"><a href="/phala-cloud-community/deployment/" class="nav-list-link">CVM Deployment</a></li><li class="nav-list-item"><a href="/phala-cloud-community/deployment/access-your-applications/" class="nav-list-link">Access Your Applications</a></li><li class="nav-list-item"><a href="/phala-cloud-community/management/" class="nav-list-link">CVM Management</a></li><li class="nav-list-item"><a href="/phala-cloud-community/deployment/debug-your-application/" class="nav-list-link">Debug Your Application</a></li><li class="nav-list-item"><a href="/phala-cloud-community/resources/" class="nav-list-link">Resources</a></li><li class="nav-list-item"><a href="/phala-cloud-community/deployment/deployment-cheat-sheet/" class="nav-list-link">Debug Your Application</a></li><li class="nav-list-item"><a href="/phala-cloud-community/cloud-api/" class="nav-list-link">Cloud APIs</a></li><li class="nav-list-item"><a href="/phala-cloud-community/references/" class="nav-list-link">Reference Architectures</a></li><li class="nav-list-item"><a href="/phala-cloud-community/pricing/" class="nav-list-link">Pricing</a></li><li class="nav-list-item"><a href="/phala-cloud-community/glossary/" class="nav-list-link">Glossary</a></li><li class="nav-list-item"><a href="/phala-cloud-community/faqs/" class="nav-list-link">FAQs</a></li></ul> <div class="nav-category"></div> <ul class="nav-list"></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Phala Cloud Docs" aria-label="Search Phala Cloud Docs" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <div id="main-content" class="main-content"> <main> <h1 id="-cvm-management"> <a href="#-cvm-management" class="anchor-heading" aria-labelledby="-cvm-management"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 💊 CVM Management </h1> <h3 id="check-logs"> <a href="#check-logs" class="anchor-heading" aria-labelledby="check-logs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Check Logs </h3> <p>There are two type of logs in Phala TEE cloud. The CVM log and the docker logs.</p> <p><strong>CVM log</strong>: By clicking on the <strong>Serial Logs</strong> in the CVM card, you can view the CVM log. The CVM log allows you to see how your application is bootstrapped, such as generating the default RA report and downloading Docker images.</p> <p><img src="/phala-cloud-community/imgs/cvm-log.png" alt="cvm-log" /></p> <p><strong>Docker logs:</strong> This is your application’s output log. If you chose to make your Docker logs public during deployment in the <strong>Advanced Features</strong> section, anyone with the log URL can view the logs. To view the log, go to the detailed page and navigate to the <strong>Containers</strong> section.</p> <p><img src="/phala-cloud-community/imgs/container-log.png" alt="container-log" /></p> <h3 id="set-private-log-viewer"> <a href="#set-private-log-viewer" class="anchor-heading" aria-labelledby="set-private-log-viewer"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Set Private Log Viewer </h3> <p>In most cases, you may not want anyone except specific individuals to see the logs. To make your Docker logs private, you can configure a log viewer in the Docker Compose file. For example, you can use the open-source log viewer <a href="https://github.com/amir20/dozzle">Dozzle</a>.</p> <ol> <li> <p>Generate user data</p> <p>On your local machine, generate a Dozzle user authority token using the Dozzle container by running the following command. In this example, we set the username as “Admin,” the password as “secret,” and the role as “admin.”</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">docker</span> <span class="n">run</span> <span class="n">amir20</span><span class="o">/</span><span class="n">dozzle</span> <span class="n">generate</span> <span class="o">--</span><span class="n">name</span> <span class="n">Admin</span> <span class="o">--</span><span class="n">email</span> <span class="n">me</span><span class="nd">@email.net</span> <span class="o">--</span><span class="n">password</span> <span class="n">secret</span> <span class="n">admin</span> <span class="o">|</span> <span class="n">base64</span> <span class="o">-</span><span class="n">w</span> <span class="mi">1000</span>
</code></pre></div> </div> </li> <li> <p>Then, setup Dozzle in Docker compose file.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">services</span><span class="p">:</span>
   <span class="c1"># Viewable logs with dozzle
</span>   <span class="n">setup</span><span class="p">:</span>
     <span class="n">image</span><span class="p">:</span> <span class="n">busybox</span>
     <span class="n">restart</span><span class="p">:</span> <span class="sh">"</span><span class="s">no</span><span class="sh">"</span>
     <span class="n">volumes</span><span class="p">:</span>
       <span class="o">-</span> <span class="n">dozzle</span><span class="o">-</span><span class="n">data</span><span class="p">:</span><span class="o">/</span><span class="n">dozzle</span><span class="o">-</span><span class="n">data</span><span class="o">/</span>
     <span class="n">command</span><span class="p">:</span> <span class="o">&gt;</span>
       <span class="n">sh</span> <span class="o">-</span><span class="n">c</span> <span class="sh">'</span><span class="s">echo </span><span class="sh">"</span><span class="s">use authority token</span><span class="sh">"</span><span class="s"> | base64 -d &gt; /dozzle-data/users.yml || true</span><span class="sh">'</span>
    
   <span class="n">dozzle</span><span class="p">:</span>
     <span class="n">container_name</span><span class="p">:</span> <span class="n">dozzle</span>
     <span class="n">image</span><span class="p">:</span> <span class="n">amir20</span><span class="o">/</span><span class="n">dozzle</span><span class="p">:</span><span class="n">latest</span>
     <span class="n">depends_on</span><span class="p">:</span>
       <span class="o">-</span> <span class="n">setup</span>
     <span class="n">environment</span><span class="p">:</span>
       <span class="o">-</span> <span class="n">DOZZLE_AUTH_PROVIDER</span><span class="o">=</span><span class="n">simple</span>
     <span class="n">volumes</span><span class="p">:</span>
       <span class="o">-</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">docker</span><span class="p">.</span><span class="n">sock</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">docker</span><span class="p">.</span><span class="n">sock</span>
       <span class="o">-</span> <span class="n">dozzle</span><span class="o">-</span><span class="n">data</span><span class="p">:</span><span class="o">/</span><span class="n">data</span><span class="o">/</span>
     <span class="n">ports</span><span class="p">:</span>
       <span class="o">-</span> <span class="mi">8080</span><span class="p">:</span><span class="mi">8080</span>
</code></pre></div> </div> </li> <li> <p>Once the application is running, you will only be able to view the logs using the username and password you set earlier, accessed through the relevant container’s public endpoint.</p> </li> </ol> <h3 id="monitor-your-application"> <a href="#monitor-your-application" class="anchor-heading" aria-labelledby="monitor-your-application"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Monitor Your Application </h3> <p>It’s beneficial to have a way to monitor your application, allowing you to check resource usage, network traffic, and more. For instance, by setting up a node-exporter service in your Docker Compose file, you can connect it with Grafana to enable real-time monitoring.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1"># Grafana metrics with node_exporter
</span>  <span class="n">services</span><span class="p">:</span>
	  <span class="n">node_exporter</span><span class="p">:</span>
	    <span class="n">image</span><span class="p">:</span> <span class="n">quay</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">prometheus</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">exporter</span><span class="p">:</span><span class="n">latest</span>
	    <span class="n">container_name</span><span class="p">:</span> <span class="n">node_exporter</span>
	    <span class="n">command</span><span class="p">:</span>
	      <span class="o">-</span> <span class="sh">'</span><span class="s">--path.rootfs=/host</span><span class="sh">'</span>
	    <span class="n">network_mode</span><span class="p">:</span> <span class="n">host</span>
	    <span class="n">pid</span><span class="p">:</span> <span class="n">host</span>
	    <span class="n">restart</span><span class="p">:</span> <span class="n">unless</span><span class="o">-</span><span class="n">stopped</span>
	    <span class="n">volumes</span><span class="p">:</span>
	      <span class="o">-</span> <span class="sh">'</span><span class="s">/:/host:ro,rslave</span><span class="sh">'</span>
	
</code></pre></div></div> <h3 id="upgrade-application"> <a href="#upgrade-application" class="anchor-heading" aria-labelledby="upgrade-application"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Upgrade Application </h3> <p>Your application is upgradable even when running inside a TEE. Thanks to the flexible design of the Dstack SDK, the application is not locked into specific hardware. To execute an upgrade, you need to click <strong>Shutdown</strong> on your CVM, then click <strong>Upgrade</strong> to enter the upgrade window.</p> <p><img src="/imgs/upgrade-cvm.png" alt="upgrade-cvm" /></p> <p>In the upgrade window, you need to set the new Docker Compose file and environment variables for your application. Note that the <strong>new environment variables will completely override the old ones</strong>, so you must also include any variables you do not intend to update. Once you’ve set everything, click the <strong>Upgrade</strong> button to execute the upgrade. <strong>After the upgrade is complete, you’ll need to start the CVM manually</strong>.</p> <p><img src="/phala-cloud-community/imgs/update-env.png" alt="update-env" /></p> <h3 id="resize-resource"> <a href="#resize-resource" class="anchor-heading" aria-labelledby="resize-resource"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Resize Resource </h3> <p>Phala TEE Cloud supports adjusting compute resources on demand. To do this, click <strong>Resize</strong> on the CVM card and adjust the resources as needed. Remember, you must shut down the CVM before executing the resize, and then start it again after the changes are saved.</p> <p><img src="/phala-cloud-community/imgs/resize-cvm.png" alt="resize-cvm" /></p> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
